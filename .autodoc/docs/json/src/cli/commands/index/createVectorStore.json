{
  "fileName": "createVectorStore.ts",
  "filePath": "src/cli/commands/index/createVectorStore.ts",
  "url": "https://github.com/context-labs/autodoc/src/cli/commands/index/createVectorStore.ts",
  "summary": "The code in this file is responsible for processing a directory of text files, splitting the text into chunks, and creating a vector store using the HNSWLib library and OpenAIEmbeddings.\n\nThe `processFile` function takes a file path as input and returns a Promise that resolves to a Document object. It reads the file contents and creates a Document object with the file contents as `pageContent` and the file path as metadata.\n\nThe `processDirectory` function takes a directory path as input and returns a Promise that resolves to an array of Document objects. It reads the files in the directory and calls `processFile` for each file. If a file is a directory, it calls `processDirectory` recursively. The function accumulates all the Document objects in an array and returns it.\n\nThe `RepoLoader` class extends the `BaseDocumentLoader` class and has a constructor that takes a file path as input. It has a `load` method that calls the `processDirectory` function with the file path and returns the resulting array of Document objects.\n\nThe `createVectorStore` function is an async function that takes an AutodocRepoConfig object as input, which contains the root directory and output file path. It creates a RepoLoader instance with the root directory, loads the raw documents, and splits them into chunks using the `RecursiveCharacterTextSplitter` class. It then creates a vector store using the HNSWLib library and OpenAIEmbeddings, and saves the vector store to the output file path.\n\nExample usage:\n\n```javascript\nconst config = {\n  root: './data/documents',\n  output: './data/vector_store',\n};\n\ncreateVectorStore(config).then(() => {\n  console.log('Vector store created successfully');\n});\n```\n\nThis code snippet would process all the text files in the `./data/documents` directory, split the text into chunks, create a vector store using the HNSWLib library and OpenAIEmbeddings, and save the vector store to the `./data/vector_store` file.",
  "questions": "1. **Question:** What is the purpose of the `processFile` function and how does it handle errors?\n   **Answer:** The `processFile` function reads the content of a file and creates a `Document` object with the file contents and metadata. If there is an error while reading the file, it rejects the promise with the error.\n\n2. **Question:** How does the `processDirectory` function handle nested directories and files?\n   **Answer:** The `processDirectory` function iterates through the files in a directory. If it encounters a subdirectory, it calls itself recursively to process the subdirectory. If it encounters a file, it processes the file using the `processFile` function and adds the resulting `Document` object to the `docs` array.\n\n3. **Question:** What is the purpose of the `createVectorStore` function and how does it use the `RepoLoader` class?\n   **Answer:** The `createVectorStore` function is responsible for creating a vector store from a given repository. It uses the `RepoLoader` class to load all the documents from the repository, splits the text into chunks using the `RecursiveCharacterTextSplitter`, and then creates a vector store using the `HNSWLib.fromDocuments` method with the `OpenAIEmbeddings`. Finally, it saves the vector store to the specified output path."
}